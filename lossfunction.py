# -*- coding: utf-8 -*-
"""LossFunction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/16kt1lWRwyMmcdx4vtvFdeHC9IpWOeFdV

# **Hàm mất mát với 1 mẫu**

Quá trình **tính hàm mất mát (loss) và đạo hàm riêng với một mẫu duy nhất**, theo công thức:

![Screenshot 2025-06-18 090309.png](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAU8AAAA9CAYAAAAtUOuMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABLNSURBVHhe7Z0NbFxVdsf/rZBwhYyTimFSMuCWnWBvcOKUTGxKB7sbG6cotlPWH2GJNxSbeEtsQyFxFJKmBQe0u5SVgh3UJEsWYoIWPNGycSTCDFT1mFWWsVlgDIRMUCIPBWkGse1MFDSuYun23vfus2fGb76eDX5Ozk96mXnX4/jdd88995xzzzvzJ4wDgiAIIif+VL4SBEEQOUDKkyAIwgCkPAmCIAxAypMgCMIApDwJgiAMQMqTIAjCAKQ8CYIgDEDKkyAIwgCkPAmCIAxAypMgCMIApDwJgiAMQMqTIAjCAKQ8CYIgDEDKkyAIwgCkPAmCIAxAypMgCMIApDwJgiAMQMqTIAjCAKQ8iUQmJxD+wAPPB0FEv5FtBHGlMRFFYHgQ3tNhRCdkWxKkPIlpzvahrqoFh/4wDt/PGnHjXyxD40sB+UOCuDKInuzEnY274TkbhOtRJ268YQ12D0flT6ehL4AjJCPYfeNeFL53Au1WtWXsyRVw/iKCdvd/49m/UdsI4rIm3I865xi2f/QsKvNEQxSujTei7WQl9n96ApuXKp9SIMuTUDnvgyfqxfbmPgRl08r6Zli58PS/PiJbCOIy530vvOFDqHvMIxsKUNdUw1+9cL0VVpskV67y/OMgOr9fjb7z8vyyZgKerWtQl84Fv7keO/6xCZsfqkGhbMI1eVgk35qd6IlOLKuaVvwLmwkEnqvGsq0e/o7IhuDz1Vizw8uX+jR840Gnow79Z+W5HhU/wdONTei+t1w2AHlXF8h3ieTstodHB+H7Qp7MYAnK68pgvUqempWoB20lbcChj3H4bv0bs+CYjMJz4kOU31PJ10odJgPoq1qDgR+O4p1HimRjesIH+QTuDpjebY+ebENJO3D448OouQyGM/DcnVjzm2aM/mcXisw+l75loqc98AbG4f+vMQi7r+zB/di8Uv1ZIlz+20vQhsP4+FCN/hwQnO3DnbcPoPndd9B1i2zLgPex61H3QvkMtx1CeWZPiA1stjN7sZ3ZFuez/Hz1sPFz0WZf3cN88pPmJcSOrOfX3G3+K82aS3xc7rOpY7HlOItcku3JfHGE1ebbWIcnJhvSEDnOWi35rKR7iEVkkymRfdp2Sp4vdE5tY7b8WnbkC3l+heN7ysF1iyrb+fl21vO+/IEel3xsmy2fOfePywZ9Qi/WsnxbB3NflA3pCDzDHFy+al88IxumyVF5aqgKSOnQFrdsWxhEXA38uhvYgKk1Qg5oinMtX7jO+VhPBVeg9w2wUAoF6n+ihAvONuZLpWAFl86wXv7/OJ/wmVtx8qsbaOYy2Dxg8uvMkkt+1nMrX7Ce8MsGQuHiAGsQusbC5VY2pUKd3xkWH3mfMxpQETdrtdnYJldINiRiUHm6WYeyEuSzBlcWVoxZkDfN8uiQbFjoxNjQo9zi3xynLKUytfM+6o7MFwdZFR+32hf1BUIoJPcWR9xKG2ORiEnH+P0eVpJvYdu88nyBo078KnbwMrE6h7os3MuRJ7OBW+MWoW/4IplREi8NsW3cY8qkGEMHqtIrWWFArHVw2ZLL8iU+D5IsVWPKkwutXVGe/I+nmoNm5I1Wfs0ZTP+FRiymI1C8LaWUSa/h1h420xFh7My+hsSVlrstm57V++T8497C+2HvYZeHnTbOesuzVBALBDE+rW/Ik1ngf8KuGGqpF/xEfN0W/vlNbCCdWx4S4R5u5T+lJ9vcgHiogfWMxPkzg62sdVC+lxjabQ+e8ijBW1jLsErmBC4EPK+7gLwNWPfXsuFyIC8PSjpaArxtZqPEisq7ioDPB+FJyjQIvFSHxl/nYdHwXnQ+3KkeO/px9S3ZbTB9p0x68NqrvKf3rIPu/sFC4/wg+k8DlXdX6IznlUwYH44KbWNFWWl2yqbsB3X830G8Oaye62KtRM1yrstOeJIyNKLw7nBi27klCL+8e2oetPw8iOLkaSCVaA7E1DgT19qWBbXp4lPM+Uwre8R/hPV0dbBdB3y6Gy8R/xDzfy1P5pHYOTfr3dnBOp46zsZ1OhQ7N8SGzqXoqXSDElbyYC9zKt5E8mFSS132IW3Y6FKE+V/uYR1du9jBUzpRUfFzrz/1Btt3iLKJkelex8aZe98u1rGzl7l1xjYW8rMhf1w/Iz52cCfve7wFpSH6/ptetkvI+j73lAxlkv9cmBPLMy7eOXTxjNp/Pp69nvHU81halZn0k2qhJnnPno442Y8/GmZYsgYsz2F4T6rvKsoW0Jr/uQ++Cb7gLC9KubKLlBfHowGU1hXC112Nkl1JyeHn+1DtrIPzcS2Bdp4424fa9f3A2jLgpRasaOxXPQENbpV1rKpD3X2/1M97vHklRBabd8Svngtu6sI7Fy7gwozjM+wxoaUefN+HCW6NlH4v5WjCs9WBxz4pRf1SH7avK8H238sfSURuoLPWicfekg3ziH/Ey/8tRXGq9BmRara+Gv185FaGe9G4qgn9X8qfCSa9+JcVTj7mvdCyeT2PV2P7833Yvr0/UQ7EwxC3O9BzeglqGpuwZKQNK5a1oe/JO+H41yDK76lH9GUu/w+bIM90zMc1DqfAjU7HbvisNWhqXAJf6wosa/fo53Vai1HExWLC50ub91u4XJkFGBlTzxXu2q8zB8RxDE3XyM9IcleeH/jgVt5Uov7O2ToYYbjuX4Zl3zd6tMCVmPSfmkAAQlUsWpQiAyzqQtvDi/GK+2nUr7Tiz0TTcOLNDw97FMEsunUe3djJMey9z4PNbx9F113FyBPSM+xV+jbFqAcnxOvKoumE93isS3C9eP08lKh0Z0vYhRbdccryuN+V9fUEPlFGEymH81gbOha9grd/Wo9SqzKafLFIGE1431JGE6vmPSoR5P0RrwUoSJqgGmNPt8Dz49/h6CP1WHWdGHQvvPGTfvQE+oWmKyvlPVIpr2tS8x3/TzmVROFqfxD/u/c9HNvdhMqKSnS11Cjyv/v5crxwbA8WedrQz//v6PuBuZUPA4x5jqsK/IZmHH73GPbcW8mvuQt7/rkI0VdbsFfXNbei8Gb+8mkw7fVbrcosQPBLg72UFmjWjO93qmbsXAXqL0ZYKBQydnydxmVLRtksSu1GjO9zMMc+NT8spux6Jpv9WrjCMr85haIfWnqYtnG3/giL9zwyB9j9rMfOf6+8l6XPiMud2Nc645TlkbybmQ5lsyi/leknyonNFwfrPSfepxi3HNJfvn3kZlGq8bjkZq2LeV8VN1qOXZK7mWrMlfsULx8ju5ht7cEEedHk3S5TpHw71bzKqgOzk47Zu+1aSuTMcIaYr/HXnIg25qnkQyLnjzbvcyXHJ4wm4Np4Pdq42573T2/jq2e426hLEK7HvSj66WbzBPO5S37tRheaXruAw3fLtjiip70ILa1EUUEY/bXL0DlciO53P8Ke5fID8KDz2kbuNjXh6P8cRn26Jz8mwxg54UNInubCkrJ6lMU/xZDMlyMYQZnymZEd16P6wATqf/UVjjZqXkAQfZUrsPuDIux5bxTdum4g/8zt/DN4Gh+926VvnZocT/u1aHy1CccuHIZ48jgRUU4shCUVRSgQhR6WdcJ7UzdGP94zZZXhrU5c29APNB7FhV/Vy8YU8Hs+OGJoNLN84i7DeAh5+oAblWuswO+34/p1hzBRdxhfvdIkQ1CazM4c8+Bza1AdOYzP/k3ORN4X7zcrUXnLtNfo2crv5VGknBspySDnvgMt8JUdxcO3yYZkbOWoF31KxeQg2v6ce5d57Xj7q2e51E+jyT7uPYYLh2ZKQHr5kJzvw5pVu4G9H2H0kdxnQY5ue5bxztP96PlIGM8mYlK+pqBguVCc/M2Xx9EvXIGbmtE8pTg5WriCuznl8/nI3FJVcYoY18BLwqGpx4a748In3/DJwSca8rh7k+XjZwuRibTjWYAioTj5u/Bv+7mDCxT+qHlacXLGTsngU8X0M8zzx0T6/lxlVRUnZ+T1fsWNrb+nbjp2P+mDV8iszpgHPglhQ03cXOXyE684+Z2AT4n51uDvK5QG8zA6rIafflCeZIQF4RMbGJx5DaEp9me2TOV3OllvULbpMPSoJfvkeZO47RrqrudMd0ALVzjMkvOYKnFY2y184Lhs0ONyd9s1Url93E2uEO0O9kxANs0rGdz2KWTGSPLOryYLM8ZcPK6oufspONfLHOJ3K+ZeFmbrtmtzbsbjllrIJWUI7btx23OyPIPDg2oA1lqDypuUppmc/Xdsf6EGG+OtoZSE4drqgPPvnMYO54PZbxhdJTYN+Dp7Nt3+G+A/JewUYN0d8WvdBEaGxQZFHirvmMeVLo7giFexQEoryqYtEE52FlUI4+K+XVeQ8LuzJuzCg06dccrycGzNfsMIivU/hkDaqlh+1SLDOpTHZwyY0Tq/mh+nP5zaKddFZoyAe0llcRtLauYBt8JKS9UGjeEBvHb3RtTEe0rC1X59ECNyp17bBLWurUwIF4RP7sWhUdW6mzcm1b9fekuiSz1x8jiUfJfle9ClW7AmjJCY5nmL01cFC40r8rakwNgsyEF5aruTnLuSzWjJHwfRVrUXgboNqEuxa5iIFU1HPsNnnxo9jqIp29hAURGEaEUiaYtWSYpQ9D35VjA5jDeVcEUdKtYoLabhlpvjBSsI70khDkWouCPNjQmH8BV/yVtePLehFWsTjuqOU5bHkaasr6foVmU0kdVwLufjKd8qDL+pTr7aioQ42vxRyPsjXqPpv/qEu/Z66mxiQm0tXBp/9ybgOngcGx9IjPh5d6xA9f0tqH5S3IEJDJ9UjYWK2+Jm9OQYDnXz9hvmdGnNnavE37fCep16qhLGwEuD/LUQ3f+RKl4fRlAsqmUrU/xcJRxWZgFXDcZmQWblORHlfySM8OduDMq0gMrSIrVNOz4fw+DTjVj2Vy1wRfPQ/hMtkG0ibipHOb+o8OmArgBqFBaK2x3Ah5oJMBnF4NY2uMT7+Y53xmFdqqqDaUt6AoFftGD3af42k0V1fgw+/rKg8nSTKLytnMtYGP5zaUcTfyk8JGHRaTFFscC3K6NpkninSmlZJf/XjzPpak3eXK6W3Dv/IfzaohEdxDM/V4V1+JQYVZXoyQ48c83z2JNgmQUx9gdxv6zYfA/v+9lfojc5x1WR9wZ4tjyP9nQbl98Bhf/wY764caNtRPNHhIw3onO4AE2v/C51/nH4DAK8m9Y1q9IuxsHTyixAudFpIN33lLgfErGDHA7xJIAJntiYSYwN3KdeX9rUFKUgAP/cYgdr6GpgTpudOUrFkwjGYyPfDuL5W5GeYmdVD7Sy2mIbc6wuUccgQ6UrNc1jgReguDjANvG+ZnzKLdDLqkT5xNUNrKPZyWzFDlaixA21VCaT8IkocpL5+e3ISC9rEPFqi1ORT4elhG3zjrOhnTJ1Z30ra11vZ/YNR9gZnXkYeaOV2bXftVWx3oCUI0XeuRyVlrCGfXNTTWv2qUqMhVyb1LhkcwdrWM37XbyJ9eo9MRWPsr+RqWCMjDMnpW3lgrHCIAuUGB+IbB831DY+IjEt+GzOxxRjkenNFi3XL/1mndxEmYXQmAO5GGaTbywq4iibUhEW0zYbTFdQ5IxS8Su7wiBaf4R8yiaBtvmaaSNV+Ry/F3HKdUqOMv/xrJkL5akQy7JfEuWxy0xGnHyEs+qA8VlwRSlPrVyVfkm6CF+9ncxi4UpyRDYJtN3Ib2Fn2ihnXuSrscXCNv06buAvupXixfmW1vRFXmVJuk0LqZRgKrxilzmFhREZYrv+1sIsxYkFurXkanN5ESpqmTQqSTcr5Bwv0a2WNI16rzNUXsrAlaU8OWoqkk4xZLkSiYk1tVrKosBKapYpUloEWrpKvAIQNTjFUyE2fu3pXRqlGPKt3OoyZWglV6QVza21GcMpU86UdBWtr9yFV4qfVPTqurTzjqyETsWQjZNVsXNZ13e29/mKU55KrENUW0+OlckYmnOnjPdc9LODG7hCWlyVWNdv3lHdO9sPZUwrFmLubhHrtKeseD2F8pUVJaYMPxiGewZOna/hUEM0TrZLjl3Mf5DVcsWkVNw303AmEfN00NdwGEUuPg2u9AOsLKxzYEBcgcqTI8vrJ1tpIhi/abVdSTi2FTtZa1ypLlPxxXHWUaF+j5TF7mC1O49kLpOnfbXGPnMWNp4NYhPEJpLBE4Yzwnz7NjGH3cIXQBuzV7SmL2NmIs7sc5rXOjYtqvdl2+Ke4YUkILyPxXPjSV6ZylPwNVdAxVXm2nH91ogx90PxX61x+REZ7GD2teaJS8+OGFegVcz+kHtBKHszML6/ijkyfVnhRTfrWM2t+jkKweX81cMEQRCEkXqeBEEQBClPgiAII5DyJAiCMAApT4IgCAOQ8iQIgjAAKU+CIAgDkPIkCIIwAClPgiAIA5DyJAiCMAApT4IgCAOQ8iQIgjAAKU+CIAgDkPIkCILIGeD/AV17HKwSe/2MAAAAAElFTkSuQmCC)
"""

# Dữ liệu đầu vào (1 mẫu)
x = 2.0
y = 5.0

# Tham số mô hình
w = 1.0
b = 0.5

# Bước 1: Tính dự đoán
y_hat = w * x + b

# Bước 2: Tính loss (MSE với 1 mẫu)
loss = (y_hat - y)**2

# Bươc 3: Tính đạo riêng theo w và b
dL_dw = -2*x*(y - y_hat)
dL_db = -2*(y-y_hat)

# Bước 3: In kết quả
print(f"Đầu vào x = {x}, Nhãn thật y = {y}")
print(f"Dự đoán y_hat = {y_hat}")
print(f"Hàm mất mát L = {loss}")
print(f"Đạo hàm riêng theo w: dL/dw = {dL_dw}")
print(f"Đạo hàm riêng theo b: dL/db = {dL_db}")

"""# **Hàm mất mát tổng quát**

**Hàm mất mát tổng quát (MSE)** là:

![image.png](data:image/png;base64,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)
"""

# Dữ liệu đầu vào: danh sách nhiều mẫu
x_data = [1.0, 2.0, 3.0, 4.0]    # đầu vào x_i
y_data = [2.0, 4.1, 6.0, 8.2]    # nhãn thật y_i

# Tham số mô hình ban đầu
w = 1.0
b = 0.5

# Số lượng mẫu
n = len(x_data)

# Tính tổng Loss theo công thức MSE

loss_sum = 0.0

for i in range(n):
  x_i = x_data[i]
  y_i = y_data[i]
  y_hat_i = w * x_i + b
  loss_i = (y_hat_i - y_i)**2
  loss_sum += loss_i


# Tính loss trung bình
mse_loss = loss_sum / n

# In kết quả
print("Số mẫu: ", n)
print(f"Hàm mất mát MSE: {mse_loss}")

"""# **Sử dụng Pytorch cho MSE**"""

import torch

# Dữ liệu đầu vào (n mẫu)
x = torch.tensor([1.0, 2.0, 3.0, 4.0])          # x_i
y = torch.tensor([2.0, 4.1, 6.0, 8.2])          # y_i

# Tham số mô hình (có requires_grad để tính đạo hàm)
w = torch.tensor(1.0, requires_grad=True)
b = torch.tensor(0.5, requires_grad=True)

# Tính dự đoán: y_hat = w * x + b
y_hat = w * x + b

# Tính Loss (Mean Squared Error)
loss = torch.mean((y - y_hat) ** 2)

# Hiển thị kết quả loss
print(f"Loss (MSE): {loss.item()}")

# Tính đạo hàm tự động
loss.backward()

# Hiển thị đạo hàm riêng
print(f"dL/dw = {w.grad}")
print(f"dL/db = {b.grad}")